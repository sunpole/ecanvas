<!-- CHANGLOG MODAL START -->
<div class="modal-changelog" id="modalChangelog" tabindex="-1" aria-hidden="true">
  <div class="modal-changelog-dialog">
    <div class="modal-changelog-header">
      <div class="modal-changelog-title">История изменений</div>
      <nav class="changelog-nav">
        <a href="#v1-1-1" class="changelog-nav-link">1.1.1</a>
        <a href="#v1-1-0" class="changelog-nav-link">1.1.0</a>
        <a href="#v1-0-7" class="changelog-nav-link">1.0.7</a>
        <!-- Добавляй другие версии по аналогии -->
      </nav>
      <button class="close-btn" id="closeChangelog">СПАСИБО ЗА ВНИМАНИЕ</button>
    </div>
    <div class="modal-changelog-body" id="changelogBody">
<pre>
<h3 id="v1-1-1">Версия 1.1.1</h3>
— Поддержка светлой и тёмной темы, автоподстройка по системе, кнопка переключения темы
— Вся гамма завернута в CSS-переменные
— Оптимизация адаптивности для мобильных, планшетов и ПК
— Цветовые улучшения для канваса и интерфейса
— Стартовые ссылки для changelog-якорей в модалке

<h3 id="v1-1-0">Версия 1.1.0</h3>
— Горизонтальные панели на планшетах и в landscape на мобильном
— Безопасные поля со всех краёв

<h3 id="v1-0-7">Версия 1.0.7</h3>
— Базовая сетка игрового поля
— Фиксы подвалов
</pre>
    </div>
  </div>
</div>

<style>
/* MODAL */
.modal-changelog {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  z-index: 4000;
  background: rgba(24,27,33,0.66);
  align-items: center;
  justify-content: center;
  transition: opacity 0.25s;
}
.modal-changelog[aria-hidden="false"] {
  display: flex;
}
.modal-changelog-dialog {
  background: #fff;
  color: #23272e;
  border-radius: 12px;
  max-width: 90vw;
  width: 420px;
  box-shadow: 0 8px 38px #162e4a2e;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  max-height: 85vh;
}
.modal-changelog-header {
  background: #f6f7f9;
  color: #23272e;
  border-bottom: 1px solid #dadcdf;
  padding: 14px 18px 12px 18px;
  display: flex;
  flex-direction: column;
  position: sticky;
  top: 0;
  z-index: 10;
}
.modal-changelog-title {
  font-weight: bold;
  font-size: 1.15rem;
  margin-bottom: 8px;
  letter-spacing: 0.01em;
}
.changelog-nav {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5em;
  margin-bottom: 10px;
}
.changelog-nav-link {
  color: #20539f;
  background: #d9e8fa;
  padding: 3px 10px;
  border-radius: 8px;
  font-size: .95em;
  font-weight: 500;
  text-decoration: none;
  transition: 0.15s;
}
.changelog-nav-link:hover, .changelog-nav-link:focus {
  background: #b4cfed;
  color: #11336b;
}

.close-btn {
  margin-top: 5px;
  font-family: inherit;
  font-size: 0.98rem;
  color: #20539f;
  padding: 5px 16px;
  background: #ecf1f8;
  border: none;
  border-radius: 8px;
  letter-spacing: 0.06em;
  cursor: pointer;
  align-self: flex-end;
  transition: background 0.16s, color 0.16s;
}
.close-btn:hover, .close-btn:focus {
  background: #d8e3f4;
  color: #11336b;
}

.modal-changelog-body {
  background: #fff;
  color: #14171c;
  overflow-y: auto;
  padding: 18px 16px;
  font-size: 0.98rem;
  line-height: 1.4;
  font-family: inherit, monospace;
  max-height: 50vh;
  min-height: 120px;
  scroll-behavior: smooth;
}
.modal-changelog-body pre {
  margin: 0;
  font-family: inherit, monospace;
  font-size: 0.98rem;
  line-height: 1.43;
  white-space: pre-wrap;
}

/* MOBILE MODAL */
@media (max-width: 800px) {
  .modal-changelog-dialog { width: 98vw; min-width: 0; }
}
</style>

<script>
window.initChangelogModal = function(){
  const modal = document.getElementById('modalChangelog');
  const closeBtn = document.getElementById('closeChangelog');
  // close on ESC
  modal.addEventListener('keydown', function(e){
    if (e.key === 'Escape') closeBtn.click();
  });
  // close on outside click
  modal.addEventListener('mousedown', function(e){
    if (e.target === modal) closeBtn.click();
  });
  closeBtn.onclick = function() {
    modal.setAttribute('aria-hidden', 'true');
    document.body.style.overflow = '';
  };
  // scroll to anchors
  document.querySelectorAll('.changelog-nav-link').forEach(link=>{
    link.addEventListener('click', function(e){
      e.preventDefault();
      const tgt = document.querySelector(this.hash);
      if(tgt) tgt.scrollIntoView({behavior:'smooth', block:'start'});
    });
  });
};
</script>
<!-- CHANGLOG MODAL END -->
